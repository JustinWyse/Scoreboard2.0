<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scoreboard - Version 3.0</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link rel="stylesheet" href="styles.css?v=front2024-v30" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="loading-overlay" id="loading" style="display: none;">
      <div>
        <div class="loading"></div>
        <p style="margin-top: 16px;">Loading dashboard data...</p>
      </div>
    </div>

    <header>
      <div class="brand">
        <h1>Scoreboard - Version 3.0</h1>
        <div class="subtitle">Comprehensive analytics dashboard with year-over-year comparisons, multi-category analysis, and side-by-side visualizations across all performance metrics.</div>
      </div>
    </header>

    <!-- NEW IN 3.0 -->
    <div class="intro-banner" id="intro_banner" style="padding: 1rem 1.5rem;">
      <div class="intro-content">
        <p style="margin: 0;"><strong>ğŸ‰ New in Version 3.0:</strong> Year-over-year comparisons with side-by-side visualizations, multi-category analysis for deeper insights, and fixed SOMA duplicate records bug. Additional performance improvements and bug fixes included.</p>
        <button onclick="document.getElementById('intro_banner').style.display='none'" class="dismiss-btn" style="margin-top: 0.5rem;">Dismiss</button>
      </div>
    </div>

    <section class="filter-group">
      <h2 class="controls-header">Scoreboard Controls</h2>
      <div id="controls">
        <label>ğŸ“… Date from: <input type="date" id="date_from"></label>
        <label>ğŸ“… Date to: <input type="date" id="date_to"></label>
        
        <label class="comparison-toggle" style="display: flex; align-items: center; gap: 0.5rem;">
          <input type="checkbox" id="compare_year_over_year" style="width: 18px; height: 18px;">
          <span>ğŸ“Š Compare 1 Year Ago</span>
        </label>
        
        <label>ğŸ“Š Group by: <select id="group_by">
          <option value="week">Week</option>
          <option value="day">Day</option>
          <option value="month">Month</option>
        </select></label>
        
        <label>ğŸ‘¤ Instructor: <select id="instr_select"><option value="">All</option></select></label>
        
        <div class="facility-toggles">
          <label>ğŸ¢ Facilities:</label>
          <div id="facility_toggles" class="toggle-group"></div>
        </div>
        
        <!-- Multi-Category Comparison -->
        <div class="category-comparison" style="grid-column: 1 / -1;">
          <label style="display: block; margin-bottom: 0.75rem; color: var(--front-text-secondary); font-size: 0.875rem; font-weight: 600;">
            ğŸ“‚ Select Categories (up to 3):
          </label>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <label>Category 1: <select id="category_compare_1"><option value="">None</option></select></label>
            <label>Category 2: <select id="category_compare_2"><option value="">None</option></select></label>
            <label>Category 3: <select id="category_compare_3"><option value="">None</option></select></label>
          </div>
        </div>
        
        <button id="apply_filter">âœ“ Apply Filters</button>
        <button id="reset">â†» Reset All</button>
      </div>
    </section>

    <main>
      <div id="error_display" class="error" style="display: none;"></div>
      <div id="success_display" class="success" style="display: none;"></div>

      <!-- KPI Dashboard Section -->
      <section class="dashboard-section">
        <div class="section-header">
          <h2>Key Performance Indicators</h2>
        </div>
        <div id="kpis" class="kpis section-content"></div>
      </section>

      <div class="export-controls">
        <button class="export-btn" id="export_csv">ğŸ“Š Export Data (CSV)</button>
        <button class="export-btn" id="export_json">ğŸ’¾ Export Data (JSON)</button>
      </div>

      <!-- Performance Analytics Section -->
      <section class="dashboard-section">
        <div class="section-header">
          <h2>Performance Analytics</h2>
        </div>
        <div id="charts" class="section-content">
          <div id="ts_chart" class="chart full-width"></div>
          <div id="avg_attendance_chart" class="chart full-width"></div>

          <div class="chart-group">
            <h3 class="chart-group-title">Instructor Performance</h3>
            <div id="bar_chart" class="chart"></div>
            <div id="instructor_pie_chart" class="chart"></div>
            <div id="low_performing_chart" class="chart"></div>
          </div>

          <!-- Category Breakdown Section -->
          <div class="chart-group">
            <h3 class="chart-group-title">Category Breakdown</h3>
            <div id="category_pie_chart" class="chart"></div>
          </div>
        </div>
      </section>

      <!-- Class Performance Section -->
      <section class="dashboard-section">
        <div class="section-header">
          <h2>Class Performance</h2>
        </div>
        <div id="charts-section2" class="section-content">
          <div class="chart-group">
            <h3 class="chart-group-title">Class Performance</h3>
            <div id="top_classes_chart" class="chart"></div>
            <div id="class_pie_chart" class="chart"></div>
            <div id="low_performing_classes_chart" class="chart"></div>
          </div>
        </div>
      </section>

      <!-- Facility Performance Section -->
      <section class="dashboard-section">
        <div class="section-header">
          <h2>Facility Performance</h2>
        </div>
        <div id="charts-section3" class="section-content">
          <div class="chart-group">
            <h3 class="chart-group-title">Facility Performance</h3>
            <div id="fac_chart" class="chart"></div>
            <div id="facility_pie_chart" class="chart"></div>
            <div id="fac_avg_chart" class="chart"></div>
          </div>
        </div>
      </section>

    </main>

    <script src="category_analysis.js?v=front2024-v30"></script>
    <script src="app.js?v=front2024-v30"></script>
  </body>
</html>
